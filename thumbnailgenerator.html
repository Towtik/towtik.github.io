<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thumbnail AI</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Inter:wght@400;600;800&display=swap">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <style>
        :root {
            /* Pixel "Material You" Palette */
            --md-sys-color-primary: #d0e4ff;
            --md-sys-color-on-primary: #00315e;
            --md-sys-color-secondary: #3b4858;
            --md-sys-color-background: #1a1c1e;
            --md-sys-color-surface: #202124;
            --md-sys-color-surface-variant: #44474e;
            --md-sys-color-on-surface: #e2e2e6;
            --md-sys-color-outline: #8e9199;
            --radius-xl: 28px;
            --radius-l: 16px;
            --transition: all 0.4s cubic-bezier(0.2, 0, 0, 1);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Google Sans', 'Inter', sans-serif;
            background-color: var(--md-sys-color-background);
            color: var(--md-sys-color-on-surface);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 24px;
        }

        .header {
            text-align: center;
            margin-bottom: 2.5rem;
            width: 100%;
        }

        .header h1 {
            font-weight: 500;
            font-size: 2.5rem;
            margin: 0;
            color: var(--md-sys-color-on-surface);
            letter-spacing: -0.5px;
        }

        /* Pixel-style Preview Container */
        .preview-wrapper {
            width: 100%;
            max-width: 800px;
            aspect-ratio: 16 / 9;
            background: var(--md-sys-color-surface);
            border-radius: var(--radius-xl);
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 30px rgba(0,0,0,0.3);
            margin-bottom: 2rem;
            border: 8px solid var(--md-sys-color-surface);
        }

        #thumbnail-container {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
        }

        #background-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .overlay-blur {
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.4) 100%);
        }

        #thumbnail-text {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10%;
            font-weight: 800;
            text-transform: uppercase;
            line-height: 1.1;
            text-shadow: 0 4px 20px rgba(0,0,0,0.6);
            pointer-events: none;
            word-wrap: break-word;
            color: white;
        }

        /* Pixel Controls - Material Design 3 */
        .controls-card {
            background: var(--md-sys-color-surface);
            width: 100%;
            max-width: 800px;
            padding: 2rem;
            border-radius: var(--radius-xl);
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        @media (min-width: 640px) {
            .controls-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
            }
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--md-sys-color-on-surface);
            margin-left: 4px;
        }

        input[type="text"], select {
            background: var(--md-sys-color-surface-variant);
            border: none;
            padding: 18px;
            border-radius: var(--radius-l);
            color: var(--md-sys-color-on-surface);
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
        }

        input[type="text"]::placeholder {
            color: var(--md-sys-color-outline);
        }

        input:focus, select:focus {
            outline: 2px solid var(--md-sys-color-primary);
            background: #303134;
        }

        /* Pixel Slider */
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 48px;
            background: transparent;
        }

        input[type="range"]::-webkit-slider-runnable-track {
            width: 100%;
            height: 16px;
            background: var(--md-sys-color-surface-variant);
            border-radius: 8px;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 8px;
            background: var(--md-sys-color-primary);
            border-radius: 4px;
            margin-top: -4px;
            transition: var(--transition);
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 0.5rem;
        }

        button {
            flex: 1;
            padding: 20px;
            border-radius: 100px; /* Pill shape for Pixel */
            border: none;
            font-weight: 500;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: var(--transition);
        }

        #generate-button {
            background: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
        }

        #generate-button:hover {
            filter: brightness(1.1);
            transform: scale(1.02);
        }

        #download-button {
            background: #3c4043;
            color: #e8eaed;
        }

        #download-button:disabled {
            opacity: 0.2;
            cursor: not-allowed;
        }

        canvas { display: none; }

        .loader {
            width: 18px;
            height: 18px;
            border: 2px solid var(--md-sys-color-on-primary);
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 0.8s linear infinite;
            display: none;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

<div class="header">
    <h1>Thumbnail AI</h1>
</div>

<div class="preview-wrapper">
    <div id="thumbnail-container">
        <img id="background-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=">
        <div class="overlay-blur"></div>
        <div id="thumbnail-text">YOUR AWESOME TITLE</div>
    </div>
</div>

<div class="controls-card">
    <div class="input-group">
        <label>Heading Text</label>
        <input type="text" id="input-text" placeholder="What's your video about?" autocomplete="off">
    </div>

    <div class="controls-grid">
        <div class="input-group">
            <label>Font Style</label>
            <select id="font-select">
                <option value="Inter" selected>Inter</option>
            </select>
        </div>

        <div class="input-group">
            <label>Text Size</label>
            <input type="range" id="font-size" min="40" max="180" value="80">
        </div>
    </div>

    <div class="button-group">
        <button id="generate-button">
            <span class="loader" id="btn-loader"></span>
            <span id="btn-text">Generate Image</span>
        </button>
        <button id="download-button" disabled>Download PNG</button>
    </div>
</div>

<canvas id="thumbnail-canvas" width="1280" height="720"></canvas>

<script>
    const canvas = document.getElementById('thumbnail-canvas');
    const ctx = canvas.getContext('2d');
    const unsplashApiKey = 'IeadiaSXxDtLJVERyMxL3-7l1mpUPdJySuLHT_zfMGI';
    
    const generateBtn = document.getElementById('generate-button');
    const downloadBtn = document.getElementById('download-button');
    const loader = document.getElementById('btn-loader');
    const btnText = document.getElementById('btn-text');

    const fonts = ['Roboto', 'Lato', 'Montserrat', 'Raleway', 'Poppins', 'Oswald', 'Anton'];
    WebFont.load({
        google: { families: ['Inter:400,800', 'Google Sans:400,500,700', ...fonts.map(f => f + ':400,800')] },
        active: populateFontSelect
    });

    function populateFontSelect() {
        const select = document.getElementById('font-select');
        fonts.forEach(font => {
            const opt = document.createElement('option');
            opt.value = font;
            opt.textContent = font;
            select.appendChild(opt);
        });
    }

    function updateLivePreview() {
        const text = document.getElementById('input-text').value || "YOUR AWESOME TITLE";
        const font = document.getElementById('font-select').value;
        const size = document.getElementById('font-size').value;
        
        const previewText = document.getElementById('thumbnail-text');
        previewText.textContent = text;
        previewText.style.fontFamily = font;
        previewText.style.fontSize = (size / 10) + 'cqw'; 
    }

    ['input-text', 'font-select', 'font-size'].forEach(id => {
        document.getElementById(id).addEventListener('input', updateLivePreview);
    });

    generateBtn.addEventListener('click', async function() {
        const text = document.getElementById('input-text').value;
        if (!text) {
            alert("Please enter some text first!");
            return;
        }

        generateBtn.disabled = true;
        loader.style.display = 'block';
        btnText.textContent = 'Searching...';

        try {
            const response = await fetch(`https://api.unsplash.com/photos/random?query=${encodeURIComponent(text)}&orientation=landscape&client_id=${unsplashApiKey}`);
            const data = await response.json();
            const imageUrl = data.urls.regular;

            const bgImg = new Image();
            bgImg.crossOrigin = "anonymous";
            bgImg.src = imageUrl;

            bgImg.onload = function() {
                document.getElementById('background-image').src = imageUrl;
                
                const selectedFont = document.getElementById('font-select').value;
                const fontSize = document.getElementById('font-size').value;
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = 'rgba(0,0,0,0.3)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                ctx.fillStyle = 'white';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.font = `800 ${fontSize}px ${selectedFont}`;
                
                ctx.shadowColor = 'rgba(0,0,0,0.8)';
                ctx.shadowBlur = 20;
                ctx.shadowOffsetY = 10;

                wrapText(ctx, text.toUpperCase(), canvas.width/2, canvas.height/2, canvas.width * 0.85, fontSize * 1.1);

                downloadBtn.disabled = false;
                generateBtn.disabled = false;
                loader.style.display = 'none';
                btnText.textContent = 'Generate Image';
            };
        } catch (err) {
            console.error(err);
            generateBtn.disabled = false;
            loader.style.display = 'none';
            btnText.textContent = 'Generate Image';
        }
    });

    function wrapText(context, text, x, y, maxWidth, lineHeight) {
        let words = text.split(' ');
        let line = '';
        let lines = [];

        for(let n = 0; n < words.length; n++) {
            let testLine = line + words[n] + ' ';
            let metrics = context.measureText(testLine);
            let testWidth = metrics.width;
            if (testWidth > maxWidth && n > 0) {
                lines.push(line);
                line = words[n] + ' ';
            } else {
                line = testLine;
            }
        }
        lines.push(line);

        let startY = y - ((lines.length - 1) * lineHeight) / 2;
        for(let k = 0; k < lines.length; k++) {
            context.fillText(lines[k], x, startY + (k * lineHeight));
        }
    }

    downloadBtn.addEventListener('click', function() {
        const link = document.createElement('a');
        link.download = `thumbnail-${Date.now()}.png`;
        link.href = canvas.toDataURL('image/png', 1.0);
        link.click();
    });
</script>

</body>
</html>
